# ðŸ—ï¸ DEEKSHITH SYSTEM ARCHITECTURE

## ðŸ“ **COMPLETE SYSTEM OVERVIEW**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FLUTTER APP (Mobile)                         â”‚
â”‚                     final_verson (Current Workspace)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    PRESENTATION LAYER                       â”‚   â”‚
â”‚  â”‚                         (Screens)                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  1. DeekshithSurveyCreateScreen                           â”‚   â”‚
â”‚  â”‚     â””â”€ Create survey + GPS capture                        â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  2. DeekshithTopviewCaptureScreen                         â”‚   â”‚
â”‚  â”‚     â””â”€ Upload drone image                                 â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  3. DeekshithTreeListScreen                               â”‚   â”‚
â”‚  â”‚     â””â”€ Show detected trees                                â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  4. DeekshithVideoUploadScreen                            â”‚   â”‚
â”‚  â”‚     â””â”€ Upload single tree video                           â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  5. DeekshithBulkVideoUploadScreen âš¡                     â”‚   â”‚
â”‚  â”‚     â””â”€ Upload multiple videos at once                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  6. DeekshithHealthMapScreen ðŸ—ºï¸                          â”‚   â”‚
â”‚  â”‚     â””â”€ Show color-coded tree map                          â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  7. DeekshithTopviewDashboardScreen                       â”‚   â”‚
â”‚  â”‚     â””â”€ Topview-level health stats                         â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  8. DeekshithSurveyDashboardScreen                        â”‚   â”‚
â”‚  â”‚     â””â”€ Farm-level final report                            â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      SERVICE LAYER                          â”‚   â”‚
â”‚  â”‚           (DeekshithSurveyService)                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â€¢ createSurvey(farmerId, lat, lon)                       â”‚   â”‚
â”‚  â”‚  â€¢ uploadTopview(surveyId, image, order)                  â”‚   â”‚
â”‚  â”‚  â€¢ uploadTreeVideo(surveyId, order, index, video)         â”‚   â”‚
â”‚  â”‚  â€¢ uploadTreeVideosBulk(surveyId, order, videos)          â”‚   â”‚
â”‚  â”‚  â€¢ generateTopviewDashboard(surveyId, order)              â”‚   â”‚
â”‚  â”‚  â€¢ generateSurveyDashboard(surveyId)                      â”‚   â”‚
â”‚  â”‚  â€¢ getHealthMap(surveyId, order)                          â”‚   â”‚
â”‚  â”‚  â€¢ getHealthMapImage(surveyId, order)                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     HTTP CLIENT LAYER                       â”‚   â”‚
â”‚  â”‚             (DeekshithApiClient)                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â€¢ postJson(path, body)                                    â”‚   â”‚
â”‚  â”‚  â€¢ postMultipart(path, fields, file)                       â”‚   â”‚
â”‚  â”‚  â€¢ postMultipleFiles(path, fields, files)                  â”‚   â”‚
â”‚  â”‚  â€¢ getImageBytes(path)                                     â”‚   â”‚
â”‚  â”‚  â€¢ testConnection()                                        â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  baseUrl: "http://192.168.1.100:8000"                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       DATA MODELS                           â”‚   â”‚
â”‚  â”‚              (deekshith_models.dart)                       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â€¢ Survey (surveyId, farmerId, location, topviews)        â”‚   â”‚
â”‚  â”‚  â€¢ Topview (topviewId, order, treeCount, trees)           â”‚   â”‚
â”‚  â”‚  â€¢ Tree (index, x, y, dashboard, hasVideo)                â”‚   â”‚
â”‚  â”‚  â€¢ TreeDashboard (health, scores, disease)                â”‚   â”‚
â”‚  â”‚  â€¢ TopviewDashboard (stats, healthScore)                  â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†•
                         HTTP/REST API
                                 â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND SERVER (Python)                         â”‚
â”‚              Backend-backend-branch/Deekshith                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     SURVEY MODULE                           â”‚   â”‚
â”‚  â”‚             (survey/router.py + service.py)                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /survey/create                                       â”‚   â”‚
â”‚  â”‚    â””â”€ Create survey, assign ID                            â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  GET /survey/list                                          â”‚   â”‚
â”‚  â”‚    â””â”€ List all surveys                                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  GET /survey/{id}/result                                   â”‚   â”‚
â”‚  â”‚    â””â”€ Get complete survey data                             â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   TOPVIEW LINK MODULE                       â”‚   â”‚
â”‚  â”‚          (topview_link/router.py + service.py)             â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /survey/{id}/topview                                 â”‚   â”‚
â”‚  â”‚    â”œâ”€ Save topview image                                   â”‚   â”‚
â”‚  â”‚    â”œâ”€ Call /topview/detect API â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚    â””â”€ Store detection results         â”‚                    â”‚   â”‚
â”‚  â”‚                                        â”‚                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â†“                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   TOPVIEW ML MODULE                         â”‚   â”‚
â”‚  â”‚              (topview/router.py + model.py)                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /topview/detect                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Load YOLO model                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Detect trees (bounding boxes)                        â”‚   â”‚
â”‚  â”‚    â”œâ”€ Group into rows                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Assign tree numbers (1, 2, 3...)                    â”‚   â”‚
â”‚  â”‚    â””â”€ Return: detections, tree_count                       â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  Model: api/models/final_best.pt                          â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  SIDEVIEW LINK MODULE                       â”‚   â”‚
â”‚  â”‚          (sideview_link/router.py + service.py)            â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /survey/{id}/topview/{order}/tree/{index}/video     â”‚   â”‚
â”‚  â”‚    â”œâ”€ Save tree video                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Call /sideview/process_video â”€â”€â”                    â”‚   â”‚
â”‚  â”‚    â””â”€ Store tree dashboard            â”‚                    â”‚   â”‚
â”‚  â”‚                                        â”‚                    â”‚   â”‚
â”‚  â”‚  POST /survey/{id}/topview/{order}/trees/videos/bulk      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Save multiple videos            â”‚                    â”‚   â”‚
â”‚  â”‚    â”œâ”€ Process each video â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â”‚    â””â”€ Store all dashboards                                 â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â†“                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   SIDEVIEW ML MODULE                        â”‚   â”‚
â”‚  â”‚           (sideview/router.py + model.py)                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /sideview/process_video                              â”‚   â”‚
â”‚  â”‚    â”œâ”€ Extract video frames                                 â”‚   â”‚
â”‚  â”‚    â”œâ”€ Run disease detection per frame                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Classify tree parts (leaf, trunk, etc.)             â”‚   â”‚
â”‚  â”‚    â”œâ”€ Aggregate predictions                                â”‚   â”‚
â”‚  â”‚    â”œâ”€ Calculate health score                               â”‚   â”‚
â”‚  â”‚    â””â”€ Return: dashboard JSON                               â”‚   â”‚
â”‚  â”‚        {                                                    â”‚   â”‚
â”‚  â”‚          health: "healthy" / "unhealthy",                  â”‚   â”‚
â”‚  â”‚          reliability_score: 85,                            â”‚   â”‚
â”‚  â”‚          weighted_score: 78,                               â”‚   â”‚
â”‚  â”‚          dominant_disease: "leaf_rot"                      â”‚   â”‚
â”‚  â”‚        }                                                    â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  Model: Transfer learning classifier                       â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   DASHBOARD MODULE                          â”‚   â”‚
â”‚  â”‚        (dashboard/router.py + aggregator.py)               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /survey/{id}/topview/{order}/dashboard              â”‚   â”‚
â”‚  â”‚    â”œâ”€ Read all tree dashboards                             â”‚   â”‚
â”‚  â”‚    â”œâ”€ Count healthy/unhealthy                              â”‚   â”‚
â”‚  â”‚    â”œâ”€ Calculate health percentage                          â”‚   â”‚
â”‚  â”‚    â”œâ”€ Find dominant disease                                â”‚   â”‚
â”‚  â”‚    â””â”€ Return topview dashboard                             â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /survey/{id}/dashboard                               â”‚   â”‚
â”‚  â”‚    â”œâ”€ Read all topview dashboards                          â”‚   â”‚
â”‚  â”‚    â”œâ”€ Aggregate (weighted by tree count)                   â”‚   â”‚
â”‚  â”‚    â”œâ”€ Calculate farm health score                          â”‚   â”‚
â”‚  â”‚    â””â”€ Return survey dashboard                              â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      MAP MODULE                             â”‚   â”‚
â”‚  â”‚             (map/router.py + service.py)                   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  GET /survey/{id}/topview/{order}/health-map              â”‚   â”‚
â”‚  â”‚    â”œâ”€ Read topview detection                               â”‚   â”‚
â”‚  â”‚    â”œâ”€ Read tree dashboards                                 â”‚   â”‚
â”‚  â”‚    â”œâ”€ Merge tree positions + health                        â”‚   â”‚
â”‚  â”‚    â””â”€ Return JSON:                                         â”‚   â”‚
â”‚  â”‚        [                                                    â”‚   â”‚
â”‚  â”‚          {tree: 1, x: 100, y: 200, color: "green"},       â”‚   â”‚
â”‚  â”‚          {tree: 2, x: 150, y: 200, color: "red"},         â”‚   â”‚
â”‚  â”‚        ]                                                    â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  GET /survey/{id}/topview/{order}/health-map/image        â”‚   â”‚
â”‚  â”‚    â”œâ”€ Load original topview image                          â”‚   â”‚
â”‚  â”‚    â”œâ”€ Draw colored pins on tree positions                  â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ Green pin = healthy                               â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ Red pin = unhealthy                               â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ Grey pin = no video                               â”‚   â”‚
â”‚  â”‚    â”œâ”€ Add tree number labels                               â”‚   â”‚
â”‚  â”‚    â””â”€ Return annotated image (PNG)                         â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â†•                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   FILE STORAGE SYSTEM                       â”‚   â”‚
â”‚  â”‚              (storage/surveys/)                            â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  SURVEY_17/                                                â”‚   â”‚
â”‚  â”‚    â”œâ”€â”€ meta.json                                           â”‚   â”‚
â”‚  â”‚    â”‚   {                                                    â”‚   â”‚
â”‚  â”‚    â”‚     survey_id: 17,                                    â”‚   â”‚
â”‚  â”‚    â”‚     farmer_id: "F001",                                â”‚   â”‚
â”‚  â”‚    â”‚     location: {lat: 12.97, lon: 77.59},              â”‚   â”‚
â”‚  â”‚    â”‚     timestamp: "2026-01-06T10:00:00"                  â”‚   â”‚
â”‚  â”‚    â”‚   }                                                    â”‚   â”‚
â”‚  â”‚    â”‚                                                        â”‚   â”‚
â”‚  â”‚    â”œâ”€â”€ topviews/                                           â”‚   â”‚
â”‚  â”‚    â”‚   â”œâ”€â”€ 17a/                                            â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”œâ”€â”€ image.jpg                                   â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”œâ”€â”€ topview_detection.json                      â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”œâ”€â”€ trees/                                      â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â”œâ”€â”€ tree_01/                                â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ video.mp4                          â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ dashboard.json                     â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â”œâ”€â”€ tree_02/                                â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...                                â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â””â”€â”€ ...                                    â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â”œâ”€â”€ dashboard_17a.json                         â”‚   â”‚
â”‚  â”‚    â”‚   â”‚   â””â”€â”€ health_map_17a.json                        â”‚   â”‚
â”‚  â”‚    â”‚   â””â”€â”€ 17b/                                            â”‚   â”‚
â”‚  â”‚    â”‚       â””â”€â”€ ...                                        â”‚   â”‚
â”‚  â”‚    â””â”€â”€ dashboard_17.json                                   â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š **DATA FLOW DIAGRAM**

### **1. Survey Creation Flow**

```
Flutter App                    Backend
    â”‚                             â”‚
    â”‚  POST /survey/create        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚
    â”‚  {                          â”‚
    â”‚    farmer_id: "F001",       â”‚
    â”‚    location: {lat, lon}     â”‚
    â”‚  }                          â”‚
    â”‚                             â”‚
    â”‚                          [Create]
    â”‚                             â”‚
    â”‚                        Save meta.json
    â”‚                             â”‚
    â”‚                        Generate ID = 17
    â”‚                             â”‚
    â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  {survey_id: 17}            â”‚
    â”‚                             â”‚
```

### **2. Topview Detection Flow**

```
Flutter App              Backend              Topview ML
    â”‚                      â”‚                      â”‚
    â”‚  POST /topview       â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                      â”‚
    â”‚  (image.jpg)         â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   Save image                â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  POST /topview/detectâ”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
    â”‚                      â”‚  (image)             â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚                 [YOLO Model]
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚                 Detect trees
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚                 Number trees
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
    â”‚                      â”‚  {                   â”‚
    â”‚                      â”‚    tree_count: 20,   â”‚
    â”‚                      â”‚    detections: [...]  â”‚
    â”‚                      â”‚  }                   â”‚
    â”‚                      â”‚                      â”‚
    â”‚              Save detection.json            â”‚
    â”‚                      â”‚                      â”‚
    â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
    â”‚  {                  â”‚                      â”‚
    â”‚    topview_id: "17a"â”‚                      â”‚
    â”‚    tree_count: 20   â”‚                      â”‚
    â”‚  }                  â”‚                      â”‚
    â”‚                      â”‚                      â”‚
```

### **3. Video Processing Flow**

```
Flutter App              Backend              Sideview ML
    â”‚                      â”‚                      â”‚
    â”‚  POST /tree/video    â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                      â”‚
    â”‚  (video.mp4)         â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   Save video                â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  POST /sideview/     â”‚
    â”‚                      â”‚  process_video       â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
    â”‚                      â”‚  (video)             â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚             [Transfer Model]
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚             Extract frames
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚             Classify disease
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚             Detect parts
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚             Aggregate
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚             Calculate score
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                      â”‚  {                   â”‚
    â”‚                      â”‚    health: "healthy",â”‚
    â”‚                      â”‚    reliability: 85,  â”‚
    â”‚                      â”‚    weighted: 78,     â”‚
    â”‚                      â”‚    disease: "..."    â”‚
    â”‚                      â”‚  }                   â”‚
    â”‚                      â”‚                      â”‚
    â”‚              Save dashboard.json            â”‚
    â”‚                      â”‚                      â”‚
    â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
    â”‚  {tree_dashboard}   â”‚                      â”‚
    â”‚                      â”‚                      â”‚
```

### **4. Dashboard Aggregation Flow**

```
Flutter App              Backend              File Storage
    â”‚                      â”‚                      â”‚
    â”‚  POST /topview/      â”‚                      â”‚
    â”‚  dashboard           â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  Read all            â”‚
    â”‚                      â”‚  tree_*/dashboard    â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                      â”‚  [20 dashboards]     â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   [Aggregate]               â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   Count healthy             â”‚
    â”‚                   Count unhealthy           â”‚
    â”‚                   Calculate %               â”‚
    â”‚                   Find dominant             â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   Save                      â”‚
    â”‚                   dashboard_17a.json        â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
    â”‚                      â”‚                      â”‚
    â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
    â”‚  {                  â”‚                      â”‚
    â”‚    total: 20,       â”‚                      â”‚
    â”‚    healthy: 15,     â”‚                      â”‚
    â”‚    unhealthy: 5,    â”‚                      â”‚
    â”‚    health_score: 75 â”‚                      â”‚
    â”‚  }                  â”‚                      â”‚
    â”‚                      â”‚                      â”‚
```

### **5. Health Map Generation Flow**

```
Flutter App              Backend              Image Processing
    â”‚                      â”‚                      â”‚
    â”‚  GET /health-map/    â”‚                      â”‚
    â”‚  image               â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   Read detection            â”‚
    â”‚                   Read dashboards           â”‚
    â”‚                      â”‚                      â”‚
    â”‚                   Load image                â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
    â”‚                      â”‚  (original.jpg)      â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚              [OpenCV/Pillow]
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚              Draw pins
    â”‚                      â”‚              â€¢ Green: healthy
    â”‚                      â”‚              â€¢ Red: unhealthy
    â”‚                      â”‚              â€¢ Grey: unknown
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚              Add numbers
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                      â”‚  (annotated.png)     â”‚
    â”‚                      â”‚                      â”‚
    â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
    â”‚  [PNG Image Bytes]  â”‚                      â”‚
    â”‚                      â”‚                      â”‚
```

---

## ðŸ”— **ID HIERARCHY SYSTEM**

```
Survey Level: 17
    â”‚
    â”œâ”€ Topview A: 17a
    â”‚   â”‚
    â”‚   â”œâ”€ Tree 1: 17a_tree_01
    â”‚   â”œâ”€ Tree 2: 17a_tree_02
    â”‚   â”œâ”€ Tree 3: 17a_tree_03
    â”‚   â””â”€ ...
    â”‚
    â”œâ”€ Topview B: 17b
    â”‚   â”‚
    â”‚   â”œâ”€ Tree 1: 17b_tree_01
    â”‚   â”œâ”€ Tree 2: 17b_tree_02
    â”‚   â””â”€ ...
    â”‚
    â””â”€ Topview C: 17c
        â””â”€ ...
```

---

## ðŸŽ¯ **API ENDPOINT MAPPING**

| Flutter Method               | HTTP Method | Backend Endpoint                                  | Purpose               |
| ---------------------------- | ----------- | ------------------------------------------------- | --------------------- |
| `createSurvey()`             | POST        | `/survey/create`                                  | Create new survey     |
| `uploadTopview()`            | POST        | `/survey/{id}/topview`                            | Upload & detect trees |
| `uploadTreeVideo()`          | POST        | `/survey/{id}/topview/{order}/tree/{index}/video` | Single video          |
| `uploadTreeVideosBulk()`     | POST        | `/survey/{id}/topview/{order}/trees/videos/bulk`  | Multiple videos       |
| `generateTopviewDashboard()` | POST        | `/survey/{id}/topview/{order}/dashboard`          | Topview stats         |
| `generateSurveyDashboard()`  | POST        | `/survey/{id}/dashboard`                          | Survey stats          |
| `getHealthMap()`             | GET         | `/survey/{id}/topview/{order}/health-map`         | JSON data             |
| `getHealthMapImage()`        | GET         | `/survey/{id}/topview/{order}/health-map/image`   | PNG image             |

---

## ðŸ” **TECHNOLOGY STACK**

### **Frontend (Flutter)**

- **Framework**: Flutter 3.9+
- **Language**: Dart 3.9+
- **HTTP Client**: http package
- **State Management**: Provider
- **Image Picker**: image_picker
- **GPS**: geolocator

### **Backend (Python)**

- **Framework**: FastAPI
- **Language**: Python 3.8+
- **ML Framework**: PyTorch (YOLO, Transfer Learning)
- **Image Processing**: OpenCV, Pillow
- **HTTP Client**: httpx (for ML API calls)

### **ML Models**

- **Topview**: YOLOv8 (Tree Detection)
- **Sideview**: Transfer Learning (Disease Classification)

---

## ðŸ“ **STORAGE STRUCTURE**

```
Backend-backend-branch/Deekshith/storage/surveys/
â””â”€â”€ SURVEY_17/
    â”œâ”€â”€ meta.json                    # Survey metadata
    â”œâ”€â”€ topviews/
    â”‚   â”œâ”€â”€ 17a/
    â”‚   â”‚   â”œâ”€â”€ image.jpg            # Original drone image
    â”‚   â”‚   â”œâ”€â”€ topview_detection.json  # Tree positions
    â”‚   â”‚   â”œâ”€â”€ trees/
    â”‚   â”‚   â”‚   â”œâ”€â”€ tree_01/
    â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ video.mp4    # Tree video
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ dashboard.json  # Tree health
    â”‚   â”‚   â”‚   â”œâ”€â”€ tree_02/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
    â”‚   â”‚   â”‚   â””â”€â”€ ...
    â”‚   â”‚   â”œâ”€â”€ dashboard_17a.json   # Topview aggregation
    â”‚   â”‚   â””â”€â”€ health_map_17a.json  # Health map data
    â”‚   â””â”€â”€ 17b/
    â”‚       â””â”€â”€ ...
    â””â”€â”€ dashboard_17.json            # Final survey report
```

---

## ðŸ”„ **HEALTH STATUS LOGIC**

```python
# Tree Health Determination
if tree_dashboard:
    weighted_score = tree_dashboard['weighted_score']
    reliability = tree_dashboard['reliability_score']

    if weighted_score >= 70 and reliability >= 70:
        health = "healthy"
        color = "green"
    else:
        health = "unhealthy"
        color = "red"
else:
    health = "unknown"
    color = "grey"
```

---

## ðŸŽ¨ **VISUAL ELEMENTS**

### **Health Map Pins**

- ðŸŸ¢ **Green Circle** (radius: 15px) â†’ Healthy tree
- ðŸ”´ **Red Circle** (radius: 15px) â†’ Unhealthy tree
- âšª **Grey Circle** (radius: 15px) â†’ No video uploaded
- **White Text** â†’ Tree number

### **Dashboard Charts** (Suggestion)

- **Pie Chart**: Healthy vs Unhealthy distribution
- **Bar Chart**: Disease frequency
- **Line Chart**: Historical health trends

---

**Last Updated**: January 6, 2026  
**Architecture Version**: 1.0  
**Status**: Production Ready
